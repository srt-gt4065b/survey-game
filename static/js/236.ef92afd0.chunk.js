"use strict";(self.webpackChunkgamified_survey_system=self.webpackChunkgamified_survey_system||[]).push([[236],{236(e,a,s){s.r(a),s.d(a,{default:()=>o});var t=s(555),n=s(43),l=s(556),r=s(335),c=s(472),i=s(177),d=s(579);const o=e=>{let{onBack:a}=e;const{user:s,gameStats:o}=(0,i.A)(),[m,v]=(0,n.useState)([]),[h,u]=(0,n.useState)("overall"),[p,x]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{if(s.id&&s.name)try{const e=(0,c.H9)(r.db,"leaderboard",s.id),a=(await(0,c.x7)(e),{id:s.id,name:s.name,studentId:s.studentId||"",department:s.department||"",avatar:s.avatar||"\ud83c\udf93",level:o.level,experience:o.experience,coins:o.coins,totalPoints:100*o.level+o.experience+10*o.coins,questionsAnswered:o.questionsAnswered,lastUpdated:(new Date).toISOString()});await(0,c.BN)(e,a,{merge:!0}),console.log("\u2705 \ub9ac\ub354\ubcf4\ub4dc \uc5c5\ub370\uc774\ud2b8 \uc644\ub8cc")}catch(e){console.error("\u274c \ub9ac\ub354\ubcf4\ub4dc \uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328:",e)}})()},[s,o]),(0,n.useEffect)(()=>{const e=(()=>{x(!0);const e=(0,c.P)((0,c.rJ)(r.db,"leaderboard"),(0,c.My)("totalPoints","desc"),(0,c.AB)(100));return(0,c.aQ)(e,e=>{const a=e.docs.map((e,a)=>(0,t.A)({id:e.id,rank:a+1},e.data()));v(a),x(!1)})})();return()=>e()},[]);const j=()=>{const e=m.findIndex(e=>e.id===s.id);return-1!==e?e+1:"-"},N=[{id:"1",rank:1,name:"\uae40\ucca0\uc218",department:"AI\uacbd\uc601\ud559\uacfc",level:15,totalPoints:1520,avatar:"\ud83c\udf93"},{id:"2",rank:2,name:"\uc774\uc601\ud76c",department:"\ucef4\ud4e8\ud130\uacf5\ud559\uacfc",level:14,totalPoints:1450,avatar:"\ud83d\udc69\u200d\ud83c\udf93"},{id:"3",rank:3,name:"\ubc15\ubbfc\uc218",department:"AI\uacbd\uc601\ud559\uacfc",level:13,totalPoints:1380,avatar:"\ud83e\uddd1\u200d\ud83c\udf93"},{id:"4",rank:4,name:"\uc815\uc18c\uc5f0",department:"\uacbd\uc601\ud559\uacfc",level:12,totalPoints:1250,avatar:"\ud83d\udc68\u200d\ud83c\udf93"},{id:"5",rank:5,name:"\ucd5c\uc900\ud638",department:"\uc18c\ud504\ud2b8\uc6e8\uc5b4\ud559\uacfc",level:11,totalPoints:1180,avatar:"\ud83c\udfaf"},{id:"user",rank:j(),name:s.name,department:s.department,level:o.level,totalPoints:o.totalPoints,avatar:s.avatar}],b=m.length>0?m:N,k=e=>{switch(e){case 1:return"\ud83e\udd47";case 2:return"\ud83e\udd48";case 3:return"\ud83e\udd49";default:return"#".concat(e)}},y=e=>{switch(e){case 1:return"#FFD700";case 2:return"#C0C0C0";case 3:return"#CD7F32";default:return"#667eea"}};return(0,d.jsxs)("div",{className:"leaderboard-container",children:[(0,d.jsxs)("div",{className:"leaderboard-header",children:[(0,d.jsx)("button",{className:"back-button",onClick:a,children:"\u2190 \ub3cc\uc544\uac00\uae30"}),(0,d.jsx)("h1",{children:"\ud83c\udfc6 \ub9ac\ub354\ubcf4\ub4dc"})]}),(0,d.jsxs)("div",{className:"tab-menu",children:[(0,d.jsx)("button",{className:"tab-button ".concat("overall"===h?"active":""),onClick:()=>u("overall"),children:"\uc804\uccb4"}),(0,d.jsx)("button",{className:"tab-button ".concat("department"===h?"active":""),onClick:()=>u("department"),children:"\ud559\uacfc"}),(0,d.jsx)("button",{className:"tab-button ".concat("weekly"===h?"active":""),onClick:()=>u("weekly"),children:"\uc8fc\uac04"})]}),(0,d.jsxs)(l.P.div,{className:"my-rank-card",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:[(0,d.jsxs)("div",{className:"my-rank-info",children:[(0,d.jsx)("span",{className:"my-rank-label",children:"\ub0b4 \uc21c\uc704"}),(0,d.jsx)("span",{className:"my-rank-number",style:{color:y(j())},children:k(j())})]}),(0,d.jsxs)("div",{className:"my-stats",children:[(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"\ub808\ubca8"}),(0,d.jsx)("span",{className:"stat-value",children:o.level})]}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"\ud3ec\uc778\ud2b8"}),(0,d.jsx)("span",{className:"stat-value",children:o.totalPoints})]}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"\ub2f5\ubcc0"}),(0,d.jsx)("span",{className:"stat-value",children:o.questionsAnswered})]})]})]}),(0,d.jsx)("div",{className:"leaderboard-list",children:p?(0,d.jsx)("div",{className:"loading",children:"\ub85c\ub529 \uc911..."}):(()=>{switch(h){case"department":return b.filter(e=>e.department===s.department);case"weekly":return b.slice(0,10);default:return b}})().map((e,a)=>(0,d.jsxs)(l.P.div,{className:"leaderboard-item ".concat(e.id===s.id?"current-user":""),initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{delay:.05*a},whileHover:{scale:1.02},children:[(0,d.jsx)("div",{className:"rank-section",children:(0,d.jsx)("span",{className:"rank",style:{color:y(e.rank)},children:k(e.rank)})}),(0,d.jsxs)("div",{className:"player-info",children:[(0,d.jsx)("div",{className:"player-avatar",children:e.avatar}),(0,d.jsxs)("div",{className:"player-details",children:[(0,d.jsx)("div",{className:"player-name",children:e.name}),(0,d.jsx)("div",{className:"player-department",children:e.department})]})]}),(0,d.jsxs)("div",{className:"player-stats",children:[(0,d.jsxs)("div",{className:"level-badge",children:["Lv.",e.level]}),(0,d.jsxs)("div",{className:"points",children:[e.totalPoints," pts"]})]})]},e.id))}),(0,d.jsxs)("div",{className:"leaderboard-footer",children:[(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("span",{className:"stat-icon",children:"\ud83d\udc65"}),(0,d.jsxs)("span",{className:"stat-text",children:["\ucd1d ",b.length,"\uba85 \ucc38\uc5ec"]})]}),(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("span",{className:"stat-icon",children:"\ud83d\udcca"}),(0,d.jsxs)("span",{className:"stat-text",children:["\ud3c9\uade0 ",Math.round(b.reduce((e,a)=>e+a.totalPoints,0)/b.length)," pts"]})]})]})]})}}}]);
//# sourceMappingURL=236.ef92afd0.chunk.js.map