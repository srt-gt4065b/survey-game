"use strict";(self.webpackChunkgamified_survey_system=self.webpackChunkgamified_survey_system||[]).push([[979],{979:(e,s,a)=>{a.r(s),a.d(s,{default:()=>h});var t=a(555),l=a(43),n=a(472),i=a(335),r=a(177),o=a(579);const c=e=>e?Array.isArray(e)?e:e.split(/[\|,]/).map(e=>e.trim()).filter(e=>e.length>0):[],d=e=>{let{question:s,questionNumber:a,totalQuestions:t,overallNumber:n,overallTotal:i,onAnswer:r,onBack:d}=e;const[v,u]=(0,l.useState)(""),{text:m,type:h,options:x,section:j}=s,N="likert"===h?["\ud83d\ude0d Strongly Agree","\ud83d\ude42 Agree","\ud83d\ude10 Neutral","\ud83d\ude15 Disagree","\ud83d\ude21 Strongly Disagree"]:c(x);return(0,o.jsxs)("div",{className:"question-card fade-in",children:[(0,o.jsxs)("div",{className:"q-header",children:[(0,o.jsx)("div",{className:"q-section",children:j}),(0,o.jsxs)("div",{className:"q-progress-group",children:[(0,o.jsxs)("div",{className:"q-progress-chapter",children:["Chapter: ",a," / ",t]}),(0,o.jsxs)("div",{className:"q-progress-overall",children:["Overall: ",n," / ",i]})]})]}),(0,o.jsx)("h2",{className:"q-text",children:m}),"text"!==h&&(0,o.jsx)("div",{className:"q-options",children:N.map((e,s)=>(0,o.jsx)("button",{className:"q-option ".concat(v===e?"selected":""),onClick:()=>u(e),children:e},s))}),"text"===h&&(0,o.jsx)("textarea",{className:"q-textarea",placeholder:"Write your answer...",value:v,onChange:e=>u(e.target.value)}),(0,o.jsxs)("div",{className:"q-footer",children:[d&&(0,o.jsx)("button",{className:"back-btn",onClick:d,children:"\u2190 Back"}),(0,o.jsx)("button",{className:"next-btn ".concat(v?"active":""),disabled:!v,onClick:()=>{v&&(r(v),u(""))},children:"Next \u2192"})]})]})},v=e=>{let{overallProgress:s}=e;const{user:a,gameStats:t}=(0,r.A)();return(0,o.jsxs)("div",{className:"game-header",children:[(0,o.jsxs)("div",{className:"user-info-section",children:[(0,o.jsx)("div",{className:"user-avatar",children:(null===a||void 0===a?void 0:a.avatar)||"\ud83c\udf93"}),(0,o.jsxs)("div",{className:"user-details",children:[(0,o.jsx)("div",{className:"user-name",children:(null===a||void 0===a?void 0:a.name)||"Student"}),(0,o.jsxs)("div",{className:"user-meta",children:[(null===a||void 0===a?void 0:a.studentId)&&(0,o.jsxs)("span",{children:["ID: ",a.studentId]}),(null===a||void 0===a?void 0:a.department)&&(0,o.jsx)("span",{className:"user-dept",children:a.department})]})]})]}),s&&(0,o.jsxs)("div",{className:"overall-progress-section",children:[(0,o.jsxs)("div",{className:"progress-text",children:["Overall Progress: ",s.current," / ",s.total]}),(0,o.jsx)("div",{className:"progress-bar-container",children:(0,o.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(s.current/s.total*100,"%")}})})]}),(0,o.jsxs)("div",{className:"stats-row",children:[(0,o.jsxs)("div",{className:"stat-box",children:[(0,o.jsx)("div",{className:"stat-icon",children:"\u2b50"}),(0,o.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.level)||1}),(0,o.jsx)("div",{className:"stat-label",children:"Level"})]}),(0,o.jsxs)("div",{className:"stat-box",children:[(0,o.jsx)("div",{className:"stat-icon",children:"\ud83d\udcaf"}),(0,o.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.experience)||0}),(0,o.jsx)("div",{className:"stat-label",children:"EXP"})]}),(0,o.jsxs)("div",{className:"stat-box",children:[(0,o.jsx)("div",{className:"stat-icon",children:"\ud83d\udd25"}),(0,o.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.streak)||0}),(0,o.jsx)("div",{className:"stat-label",children:"Streak"})]}),(0,o.jsxs)("div",{className:"stat-box",children:[(0,o.jsx)("div",{className:"stat-icon",children:"\ud83e\ude99"}),(0,o.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.coins)||0}),(0,o.jsx)("div",{className:"stat-label",children:"Coins"})]})]})]})};function u(e){let{onComplete:s}=e;return(0,o.jsxs)("div",{className:"end-scene",children:[(0,o.jsx)("h1",{children:"\ud83c\udf89 Great Job!"}),(0,o.jsx)("p",{children:"Your survey game mission has been successfully completed!!."}),(0,o.jsx)("button",{className:"end-btn",onClick:s,children:"\ub9ac\ub354\ubcf4\ub4dc \ubcf4\uae30 \u2192"}),(0,o.jsx)("button",{className:"home-btn",onClick:()=>window.location.reload(),children:"\ucc98\uc74c\uc73c\ub85c \ub3cc\uc544\uac00\uae30"})]})}var m=a(339);const h=e=>{var s,a;let{onComplete:c}=e;const{user:h,answerQuestion:x}=(0,r.A)(),[j,N]=(0,l.useState)([]),[g,p]=(0,l.useState)(!0),[b,y]=(0,l.useState)(""),[f,q]=(0,l.useState)(0),[k,w]=(0,l.useState)({}),[A,S]=(0,l.useState)(Date.now()),[C,I]=(0,l.useState)(!1),D=(null===h||void 0===h?void 0:h.language)||"en";(0,l.useEffect)(()=>{(async()=>{try{p(!0);const e=(0,n.P)((0,n.rJ)(i.db,"questions"),(0,n.My)("id")),s=(await(0,n.GG)(e)).docs.map(e=>(0,t.A)({docId:e.id},e.data()));N(s),s.length>0&&y(s[0].category)}catch(e){m.Ay.error("Failed to load questions")}finally{p(!1),S(Date.now())}})()},[]);const O=(0,l.useMemo)(()=>[...new Set(j.map(e=>e.category))],[j]),P=(0,l.useMemo)(()=>j.filter(e=>e.category===b),[j,b]),M=P.length>0?P[f]:null,_=(0,l.useMemo)(()=>({current:Object.keys(k).length,total:j.length}),[k,j.length]);if(C)return(0,o.jsx)(u,{onComplete:c});if(g)return(0,o.jsx)("div",{className:"loading-screen",children:"Loading..."});if(!M)return(0,o.jsx)("div",{className:"loading-screen",children:"No questions available"});const B={text:(null===(s=M.text)||void 0===s?void 0:s[D])||(null===(a=M.text)||void 0===a?void 0:a.en),section:M.category,type:M.type,options:(G=M.options,G?Array.isArray(G)?G:G.split(/[\|,]/).map(e=>e.trim()).filter(e=>e.length>0):[]),required:!0};var G;return(0,o.jsxs)("div",{className:"survey-container",children:[(0,o.jsx)(v,{overallProgress:_}),(0,o.jsx)(d,{question:B,questionNumber:f+1,totalQuestions:P.length,overallNumber:M?j.findIndex(e=>e.docId===M.docId)+1:0,overallTotal:j.length,onBack:()=>{if(f>0)return void q(e=>e-1);const e=O.indexOf(b);if(e>0){const s=O[e-1],a=j.filter(e=>e.category===s);y(s),q(a.length-1)}},onAnswer:e=>{if(!M)return;const s=(Date.now()-A)/1e3,a=M.docId;w(l=>(0,t.A)((0,t.A)({},l),{},{[a]:{value:e,timeSpent:s}})),x(s,"good");const l=f+1;if(l<P.length)return q(l),void S(Date.now());const n=new Set(Object.keys((0,t.A)((0,t.A)({},k),{},{[a]:!0}))),i=O.filter(e=>j.some(s=>s.category===e&&!n.has(s.docId)));if(i.length>0)return y(i[0]),q(0),void S(Date.now());I(!0)}},M.docId)]})}}}]);
//# sourceMappingURL=979.58563247.chunk.js.map