"use strict";(self.webpackChunkgamified_survey_system=self.webpackChunkgamified_survey_system||[]).push([[979],{979:(e,s,t)=>{t.r(s),t.d(s,{default:()=>h});var a=t(555),n=t(43),l=t(472),i=t(335),r=t(177),c=t(579);const o=e=>{let{question:s,chapterNumber:t,chapterName:a,sectionIndex:l,sectionTotal:i,onAnswer:r,onBack:o}=e;const[d,u]=(0,n.useState)(""),{text:v,type:h,options:m,section:x}=s,j="likert"===h?["\ud83d\ude0d Strongly Agree","\ud83d\ude42 Agree","\ud83d\ude10 Neutral","\ud83d\ude15 Disagree","\ud83d\ude21 Strongly Disagree"]:m;return(0,c.jsxs)("div",{className:"question-card fade-in",children:[(0,c.jsxs)("div",{className:"q-header",children:[(0,c.jsxs)("div",{className:"chapter-title",children:[(0,c.jsxs)("span",{className:"chapter-number",children:["Chapter ",t,"."]}),(0,c.jsx)("span",{className:"chapter-name",children:a})]}),(0,c.jsxs)("div",{className:"section-progress",children:[l," / ",i]})]}),(0,c.jsx)("h2",{className:"q-text",children:v}),"text"!==h&&(0,c.jsx)("div",{className:"q-options",children:j.map((e,s)=>(0,c.jsx)("button",{className:"q-option ".concat(d===e?"selected":""),onClick:()=>u(e),children:e},s))}),"text"===h&&(0,c.jsx)("textarea",{className:"q-textarea",placeholder:"Write your answer...",value:d,onChange:e=>u(e.target.value)}),(0,c.jsxs)("div",{className:"q-footer",children:[o&&(0,c.jsx)("button",{className:"q-btn back-btn",onClick:o,children:"\u2190 Back"}),(0,c.jsx)("button",{className:"q-btn next-btn ".concat(d?"active":""),disabled:!d,onClick:()=>{d&&(r(d),u(""))},children:"Next \u2192"})]})]})},d=e=>{let{overallProgress:s}=e;const{user:t,gameStats:a}=(0,r.A)();return(0,c.jsxs)("div",{className:"game-header",children:[(0,c.jsxs)("div",{className:"user-info-section",children:[(0,c.jsx)("div",{className:"user-avatar",children:(null===t||void 0===t?void 0:t.avatar)||"\ud83c\udf93"}),(0,c.jsxs)("div",{className:"user-details",children:[(0,c.jsx)("div",{className:"user-name",children:(null===t||void 0===t?void 0:t.name)||"Student"}),(0,c.jsxs)("div",{className:"user-meta",children:[(null===t||void 0===t?void 0:t.studentId)&&(0,c.jsxs)("span",{children:["ID: ",t.studentId]}),(null===t||void 0===t?void 0:t.department)&&(0,c.jsx)("span",{className:"user-dept",children:t.department})]})]})]}),s&&(0,c.jsxs)("div",{className:"overall-progress-section",children:[(0,c.jsxs)("div",{className:"progress-text",children:["Overall Progress: ",s.current," / ",s.total]}),(0,c.jsx)("div",{className:"progress-bar-container",children:(0,c.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(s.current/s.total*100,"%")}})})]}),(0,c.jsxs)("div",{className:"stats-row",children:[(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\u2b50"}),(0,c.jsx)("div",{className:"stat-value",children:(null===a||void 0===a?void 0:a.level)||1}),(0,c.jsx)("div",{className:"stat-label",children:"Level"})]}),(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\ud83d\udcaf"}),(0,c.jsx)("div",{className:"stat-value",children:(null===a||void 0===a?void 0:a.experience)||0}),(0,c.jsx)("div",{className:"stat-label",children:"EXP"})]}),(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\ud83d\udd25"}),(0,c.jsx)("div",{className:"stat-value",children:(null===a||void 0===a?void 0:a.streak)||0}),(0,c.jsx)("div",{className:"stat-label",children:"Streak"})]}),(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\ud83e\ude99"}),(0,c.jsx)("div",{className:"stat-value",children:(null===a||void 0===a?void 0:a.coins)||0}),(0,c.jsx)("div",{className:"stat-label",children:"Coins"})]})]})]})};function u(e){let{onComplete:s}=e;return(0,c.jsxs)("div",{className:"end-scene",children:[(0,c.jsx)("h1",{children:"\ud83c\udf89 Great Job!"}),(0,c.jsx)("p",{children:"Your survey game mission has been successfully completed!!."}),(0,c.jsx)("button",{className:"end-btn",onClick:s,children:"\ub9ac\ub354\ubcf4\ub4dc \ubcf4\uae30 \u2192"}),(0,c.jsx)("button",{className:"home-btn",onClick:()=>window.location.reload(),children:"\ucc98\uc74c\uc73c\ub85c \ub3cc\uc544\uac00\uae30"})]})}var v=t(339);const h=e=>{var s,t;let{onComplete:h}=e;const{user:m,answerQuestion:x}=(0,r.A)(),[j,N]=(0,n.useState)([]),[p,g]=(0,n.useState)(!0),[b,f]=(0,n.useState)(""),[y,k]=(0,n.useState)(0),[w,S]=(0,n.useState)({}),[q,A]=(0,n.useState)(Date.now()),[C,I]=(0,n.useState)(!1),D=(null===m||void 0===m?void 0:m.language)||"en";(0,n.useEffect)(()=>{(async()=>{try{g(!0);const e=(0,l.P)((0,l.rJ)(i.db,"questions"),(0,l.My)("id")),s=(await(0,l.GG)(e)).docs.map(e=>(0,a.A)({docId:e.id},e.data()));N(s),s.length>0&&f(s[0].category)}catch(e){v.Ay.error("Failed to load questions")}finally{g(!1),A(Date.now())}})()},[]);const O=(0,n.useMemo)(()=>[...new Set(j.map(e=>e.category))],[j]),P=(0,n.useMemo)(()=>j.filter(e=>e.category===b),[j,b]),M=P.length>0?P[y]:null,_=(0,n.useMemo)(()=>({current:Object.keys(w).length,total:j.length}),[w,j.length]),B=P.length,G=y+1,E=O.indexOf(b)+1;if(C)return(0,c.jsx)(u,{onComplete:h});if(p)return(0,c.jsx)("div",{className:"loading",children:"Loading\u2026"});if(!M)return(0,c.jsx)("div",{children:"No questions available"});const J={text:(null===(s=M.text)||void 0===s?void 0:s[D])||(null===(t=M.text)||void 0===t?void 0:t.en),section:b,type:M.type,options:(L=M.options,L?Array.isArray(L)?L:L.split(/[\|,]/).map(e=>e.trim()).filter(e=>e.length>0):[]),required:!0};var L;return(0,c.jsxs)("div",{className:"survey-container",children:[(0,c.jsx)(d,{overallProgress:_}),(0,c.jsx)(o,{question:J,chapterNumber:E,chapterName:b,sectionIndex:G,sectionTotal:B,onBack:()=>{if(y>0)return void k(e=>e-1);const e=O.indexOf(b);if(e>0){const s=O[e-1],t=j.filter(e=>e.category===s);f(s),k(t.length-1)}},onAnswer:e=>{if(!M)return;const s=(Date.now()-q)/1e3,t=M.docId;S(n=>(0,a.A)((0,a.A)({},n),{},{[t]:{value:e,timeSpent:s}})),x(s,"good");const n=y+1;if(n<P.length)return k(n),void A(Date.now());const l=new Set(Object.keys((0,a.A)((0,a.A)({},w),{},{[t]:!0}))),i=O.filter(e=>j.some(s=>s.category===e&&!l.has(s.docId)));if(i.length>0)return f(i[0]),k(0),void A(Date.now());I(!0)}},M.docId)]})}}}]);
//# sourceMappingURL=979.b1357da1.chunk.js.map