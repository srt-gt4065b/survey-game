"use strict";(self.webpackChunkgamified_survey_system=self.webpackChunkgamified_survey_system||[]).push([[979],{979(e,s,a){a.r(s),a.d(s,{default:()=>x});var t=a(555),n=a(43),i=a(472),r=a(335),l=a(177),c=a(579);const o=e=>{let{question:s,questionNumber:a,totalQuestions:t,chapterNumber:i,chapterName:r,onAnswer:l,onBack:o,onSkip:d,onJump:m}=e;const[u,g]=(0,n.useState)(null),[h,v]=(0,n.useState)("");(0,n.useEffect)(()=>{g(null),v("")},[s]);const x=(()=>{const e=s.options;if(console.log("\ud83d\udd0d Raw options:",e,"Type:",typeof e),!e)return[];if(Array.isArray(e)){if(1===e.length&&"string"===typeof e[0]&&e[0].includes("|")){const s=e[0].split("|").map(e=>e.trim()).filter(Boolean);return console.log("\ud83d\udd27 Split from array[0]:",s),s}return console.log("\u2705 Already array:",e),e}if("string"===typeof e){if(e.includes("|")){const s=e.split("|").map(e=>e.trim()).filter(Boolean);return console.log("\ud83d\udd27 Split by pipe:",s),s}if(e.includes(",")){const s=e.split(",").map(e=>e.trim()).filter(Boolean);return console.log("\ud83d\udd27 Split by comma:",s),s}return console.log("\u26a0\ufe0f Single value:",[e.trim()]),[e.trim()]}return[]})();console.log("\ud83d\udccb Final optionList:",x,"Length:",x.length);const p=(e,s)=>{g(s)},N="text"===s.type?h.trim().length>0:null!==u,j=x.length>1;return(0,c.jsxs)("div",{className:"question-card",children:[(0,c.jsxs)("div",{className:"qc-section-header",children:[(0,c.jsxs)("div",{className:"qc-section-left",children:[(0,c.jsxs)("span",{className:"qc-section-number",children:["Section ",i,"."]}),(0,c.jsx)("span",{className:"qc-section-name",children:r})]}),(0,c.jsxs)("div",{className:"qc-section-progress",children:[a," / ",t]})]}),(0,c.jsx)("h2",{className:"qc-question-text",children:s.text}),"text"===s.type&&(0,c.jsx)("textarea",{className:"qc-textarea",placeholder:"Write your answer...",value:h,onChange:e=>v(e.target.value)}),("multi"===s.type||"likert"===s.type)&&j&&(0,c.jsx)("div",{className:"qc-options-wrapper",children:x.map((e,a)=>(0,c.jsxs)("button",{className:"qc-option-btn ".concat(u===a?"selected":""),onClick:()=>p(0,a),children:["multi"===s.type&&(0,c.jsx)("span",{className:"qc-option-number",children:a+1}),(0,c.jsx)("span",{className:"qc-option-text",children:e})]},a))}),("multi"===s.type||"likert"===s.type)&&!j&&(0,c.jsx)("div",{className:"qc-options-wrapper",children:["Strongly Agree","Agree","Neutral","Disagree","Strongly Disagree"].map((e,s)=>(0,c.jsx)("button",{className:"qc-option-btn ".concat(u===s?"selected":""),onClick:()=>p(0,s),children:(0,c.jsx)("span",{className:"qc-option-text",children:e})},s))}),(0,c.jsxs)("div",{className:"qc-button-row",children:[(0,c.jsxs)("button",{className:"qc-btn back",onClick:()=>{g(null),v(""),o&&o()},children:[(0,c.jsx)("span",{className:"btn-icon",children:"\u2190"}),(0,c.jsx)("span",{className:"btn-label",children:"Back"})]}),(0,c.jsxs)("button",{className:"qc-btn skip",onClick:()=>{g(null),v(""),d&&d()},children:[(0,c.jsx)("span",{className:"btn-icon",children:"\u23ed"}),(0,c.jsx)("span",{className:"btn-label",children:"Skip"})]}),(0,c.jsxs)("button",{className:"qc-btn jump",onClick:()=>{g(null),v(""),m&&m()},children:[(0,c.jsx)("span",{className:"btn-icon",children:"\u2192"}),(0,c.jsx)("span",{className:"btn-label",children:"Jump"})]}),(0,c.jsxs)("button",{className:"qc-btn next ".concat(N?"active":""),disabled:!N,onClick:()=>{"text"===s.type?h.trim()&&(l(h),v("")):null!==u&&(l(x[u]),g(null))},children:[(0,c.jsx)("span",{className:"btn-label",children:"Next"}),(0,c.jsx)("span",{className:"btn-icon",children:"\u2192"})]})]})]})},d=e=>{let{overallProgress:s}=e;const{user:a,gameStats:t}=(0,l.A)();return(0,c.jsxs)("div",{className:"game-header",children:[(0,c.jsxs)("div",{className:"user-info-section",children:[(0,c.jsx)("div",{className:"user-avatar",children:(null===a||void 0===a?void 0:a.avatar)||"\ud83c\udf93"}),(0,c.jsxs)("div",{className:"user-details",children:[(0,c.jsx)("div",{className:"user-name",children:(null===a||void 0===a?void 0:a.name)||"Student"}),(0,c.jsxs)("div",{className:"user-meta",children:[(null===a||void 0===a?void 0:a.studentId)&&(0,c.jsxs)("span",{children:["ID: ",a.studentId]}),(null===a||void 0===a?void 0:a.department)&&(0,c.jsx)("span",{className:"user-dept",children:a.department})]})]})]}),s&&(0,c.jsxs)("div",{className:"overall-progress-section",children:[(0,c.jsxs)("div",{className:"progress-text",children:["Overall Progress: ",s.current," / ",s.total]}),(0,c.jsx)("div",{className:"progress-bar-container",children:(0,c.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(s.current/s.total*100,"%")}})})]}),(0,c.jsxs)("div",{className:"stats-row",children:[(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\u2b50"}),(0,c.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.level)||1}),(0,c.jsx)("div",{className:"stat-label",children:"Level"})]}),(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\ud83d\udcaf"}),(0,c.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.experience)||0}),(0,c.jsx)("div",{className:"stat-label",children:"EXP"})]}),(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\ud83d\udd25"}),(0,c.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.streak)||0}),(0,c.jsx)("div",{className:"stat-label",children:"Streak"})]}),(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\ud83e\ude99"}),(0,c.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.coins)||0}),(0,c.jsx)("div",{className:"stat-label",children:"Coins"})]})]})]})},m={ko:{title:"\uc815\ub9d0 \uc218\uace0 \ub9ce\uc73c\uc168\uc2b5\ub2c8\ub2e4!",message1:"\ub2f9\uc2e0\uc758 \uc18c\uc911\ud55c \uc758\uacac\uc740",message2:"\uc5d4\ub514\ucef7\uc774 \ud559\uc0dd\ub4e4\uc5d0\uac8c",message3:"\ubcf4\ub2e4 \uac1c\uc120\ub41c \uad50\uc721\ud658\uacbd\uc744 \uc81c\uacf5\ud558\ub294\ub370",message4:"\uc18c\uc911\ud55c \uc790\uc6d0\uc73c\ub85c \uc0ac\uc6a9\ub420 \uac83\uc785\ub2c8\ub2e4.",gratitude:"\uac10\uc0ac\ud569\ub2c8\ub2e4 \ud83d\udc99",redirectText:"\ucd08 \ud6c4 \ub9ac\ub354\ubcf4\ub4dc\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4...",redirecting:"\ub9ac\ub354\ubcf4\ub4dc\ub85c \uc774\ub3d9 \uc911...",viewLeaderboard:"\ud83c\udfc6 \uc9c0\uae08 \ubc14\ub85c \ub9ac\ub354\ubcf4\ub4dc \ubcf4\uae30",returnHome:"\ud83c\udfe0 \ucc98\uc74c\uc73c\ub85c \ub3cc\uc544\uac00\uae30"},en:{title:"Thank You So Much!",message1:"Your valuable feedback",message2:"will be used as a precious resource",message3:"to help Endicott provide",message4:"an improved educational environment for students.",gratitude:"We deeply appreciate your participation \ud83d\udc99",redirectText:" seconds until redirecting to leaderboard...",redirecting:"Redirecting to leaderboard...",viewLeaderboard:"\ud83c\udfc6 View Leaderboard Now",returnHome:"\ud83c\udfe0 Return to Home"},zh:{title:"\u975e\u5e38\u611f\u8c22\u60a8!",message1:"\u60a8\u5b9d\u8d35\u7684\u610f\u89c1",message2:"\u5c06\u6210\u4e3a\u6069\u8fea\u79d1\u7279\u5927\u5b66",message3:"\u4e3a\u5b66\u751f\u63d0\u4f9b",message4:"\u66f4\u597d\u6559\u80b2\u73af\u5883\u7684\u5b9d\u8d35\u8d44\u6e90\u3002",gratitude:"\u8877\u5fc3\u611f\u8c22\u60a8\u7684\u53c2\u4e0e \ud83d\udc99",redirectText:"\u79d2\u540e\u5c06\u8df3\u8f6c\u5230\u6392\u884c\u699c...",redirecting:"\u6b63\u5728\u8df3\u8f6c\u5230\u6392\u884c\u699c...",viewLeaderboard:"\ud83c\udfc6 \u7acb\u5373\u67e5\u770b\u6392\u884c\u699c",returnHome:"\ud83c\udfe0 \u8fd4\u56de\u9996\u9875"},uz:{title:"Katta rahmat!",message1:"Sizning qimmatli fikringiz",message2:"Endicott universitetiga",message3:"talabalar uchun yaxshilangan",message4:"ta'lim muhitini yaratishda muhim manba bo'ladi.",gratitude:"Ishtirok etganingiz uchun tashakkur \ud83d\udc99",redirectText:" soniyadan keyin reytingga o'tiladi...",redirecting:"Reytingga o'tilmoqda...",viewLeaderboard:"\ud83c\udfc6 Reytingni ko'rish",returnHome:"\ud83c\udfe0 Bosh sahifaga qaytish"},vi:{title:"C\u1ea3m \u01a1n b\u1ea1n r\u1ea5t nhi\u1ec1u!",message1:"\xdd ki\u1ebfn qu\xfd b\xe1u c\u1ee7a b\u1ea1n",message2:"s\u1ebd l\xe0 ngu\u1ed3n t\xe0i nguy\xean qu\xfd gi\xe1",message3:"gi\xfap Endicott cung c\u1ea5p",message4:"m\xf4i tr\u01b0\u1eddng gi\xe1o d\u1ee5c t\u1ed1t h\u01a1n cho sinh vi\xean.",gratitude:"Ch\xfang t\xf4i v\xf4 c\xf9ng bi\u1ebft \u01a1n s\u1ef1 tham gia c\u1ee7a b\u1ea1n \ud83d\udc99",redirectText:" gi\xe2y n\u1eefa s\u1ebd chuy\u1ec3n \u0111\u1ebfn b\u1ea3ng x\u1ebfp h\u1ea1ng...",redirecting:"\u0110ang chuy\u1ec3n \u0111\u1ebfn b\u1ea3ng x\u1ebfp h\u1ea1ng...",viewLeaderboard:"\ud83c\udfc6 Xem b\u1ea3ng x\u1ebfp h\u1ea1ng ngay",returnHome:"\ud83c\udfe0 Quay v\u1ec1 trang ch\u1ee7"},mn:{title:"\u041c\u0430\u0448 \u0438\u0445 \u0431\u0430\u044f\u0440\u043b\u0430\u043b\u0430\u0430!",message1:"\u0422\u0430\u043d\u044b \u04af\u043d\u044d \u0446\u044d\u043d\u044d\u0442\u044d\u0439 \u0441\u0430\u043d\u0430\u043b",message2:"\u042d\u043d\u0434\u0438\u043a\u043e\u0442\u0442 \u0441\u0443\u0440\u0433\u0443\u0443\u043b\u044c\u0434",message3:"\u043e\u044e\u0443\u0442\u043d\u0443\u0443\u0434\u0430\u0434 \u0438\u043b\u04af\u04af \u0441\u0430\u0439\u043d",message4:"\u0431\u043e\u043b\u043e\u0432\u0441\u0440\u043e\u043b\u044b\u043d \u043e\u0440\u0447\u0438\u043d \u0431\u04af\u0440\u0434\u04af\u04af\u043b\u044d\u0445\u044d\u0434 \u0447\u0443\u0445\u0430\u043b \u044d\u0445 \u04af\u04af\u0441\u0432\u044d\u0440 \u0431\u043e\u043b\u043d\u043e.",gratitude:"\u041e\u0440\u043e\u043b\u0446\u0441\u043e\u043d\u0434 \u0431\u0430\u044f\u0440\u043b\u0430\u043b\u0430\u0430 \ud83d\udc99",redirectText:" \u0441\u0435\u043a\u0443\u043d\u0434\u044b\u043d \u0434\u0430\u0440\u0430\u0430 \u043b\u0438\u0434\u0435\u0440\u0431\u043e\u0440\u0434 \u0440\u0443\u0443 \u0448\u0438\u043b\u0436\u0438\u043d\u044d...",redirecting:"\u041b\u0438\u0434\u0435\u0440\u0431\u043e\u0440\u0434 \u0440\u0443\u0443 \u0448\u0438\u043b\u0436\u0438\u0436 \u0431\u0430\u0439\u043d\u0430...",viewLeaderboard:"\ud83c\udfc6 \u041b\u0438\u0434\u0435\u0440\u0431\u043e\u0440\u0434 \u04af\u0437\u044d\u0445",returnHome:"\ud83c\udfe0 \u041d\u04af\u04af\u0440 \u0445\u0443\u0443\u0434\u0430\u0441 \u0440\u0443\u0443 \u0431\u0443\u0446\u0430\u0445"},bn:{title:"\u0986\u09aa\u09a8\u09be\u0995\u09c7 \u0985\u09a8\u09c7\u0995 \u09a7\u09a8\u09cd\u09af\u09ac\u09be\u09a6!",message1:"\u0986\u09aa\u09a8\u09be\u09b0 \u09ae\u09c2\u09b2\u09cd\u09af\u09ac\u09be\u09a8 \u09ae\u09a4\u09be\u09ae\u09a4",message2:"\u098f\u09a8\u09cd\u09a1\u09bf\u0995\u099f \u09ac\u09bf\u09b6\u09cd\u09ac\u09ac\u09bf\u09a6\u09cd\u09af\u09be\u09b2\u09af\u09bc\u0995\u09c7",message3:"\u09b6\u09bf\u0995\u09cd\u09b7\u09be\u09b0\u09cd\u09a5\u09c0\u09a6\u09c7\u09b0 \u099c\u09a8\u09cd\u09af \u0989\u09a8\u09cd\u09a8\u09a4",message4:"\u09b6\u09bf\u0995\u09cd\u09b7\u09be \u09aa\u09b0\u09bf\u09ac\u09c7\u09b6 \u09aa\u09cd\u09b0\u09a6\u09be\u09a8\u09c7 \u0997\u09c1\u09b0\u09c1\u09a4\u09cd\u09ac\u09aa\u09c2\u09b0\u09cd\u09a3 \u09b8\u09ae\u09cd\u09aa\u09a6 \u09b9\u09ac\u09c7\u0964",gratitude:"\u0986\u09aa\u09a8\u09be\u09b0 \u0985\u0982\u09b6\u0997\u09cd\u09b0\u09b9\u09a3\u09c7\u09b0 \u099c\u09a8\u09cd\u09af \u0986\u09a8\u09cd\u09a4\u09b0\u09bf\u0995 \u0995\u09c3\u09a4\u099c\u09cd\u099e\u09a4\u09be \ud83d\udc99",redirectText:" \u09b8\u09c7\u0995\u09c7\u09a8\u09cd\u09a1 \u09aa\u09b0\u09c7 \u09b2\u09bf\u09a1\u09be\u09b0\u09ac\u09cb\u09b0\u09cd\u09a1\u09c7 \u09af\u09be\u09ac\u09c7...",redirecting:"\u09b2\u09bf\u09a1\u09be\u09b0\u09ac\u09cb\u09b0\u09cd\u09a1\u09c7 \u09af\u09be\u099a\u09cd\u099b\u09c7...",viewLeaderboard:"\ud83c\udfc6 \u098f\u0996\u09a8\u0987 \u09b2\u09bf\u09a1\u09be\u09b0\u09ac\u09cb\u09b0\u09cd\u09a1 \u09a6\u09c7\u0996\u09c1\u09a8",returnHome:"\ud83c\udfe0 \u09b9\u09cb\u09ae\u09c7 \u09ab\u09bf\u09b0\u09c7 \u09af\u09be\u09a8"},kk:{title:"\u0421\u0456\u0437\u0433\u0435 \u04af\u043b\u043a\u0435\u043d \u0440\u0430\u0445\u043c\u0435\u0442!",message1:"\u0421\u0456\u0437\u0434\u0456\u04a3 \u049b\u04b1\u043d\u0434\u044b \u043f\u0456\u043a\u0456\u0440\u0456\u04a3\u0456\u0437",message2:"\u042d\u043d\u0434\u0438\u043a\u043e\u0442\u0442 \u0443\u043d\u0438\u0432\u0435\u0440\u0441\u0438\u0442\u0435\u0442\u0456\u043d\u0435",message3:"\u0441\u0442\u0443\u0434\u0435\u043d\u0442\u0442\u0435\u0440 \u04af\u0448\u0456\u043d \u0436\u0430\u049b\u0441\u0430\u0440\u0442\u044b\u043b\u0493\u0430\u043d",message4:"\u0431\u0456\u043b\u0456\u043c \u0431\u0435\u0440\u0443 \u043e\u0440\u0442\u0430\u0441\u044b\u043d \u0436\u0430\u0441\u0430\u0443\u0434\u0430 \u043c\u0430\u04a3\u044b\u0437\u0434\u044b \u0440\u0435\u0441\u0443\u0440\u0441 \u0431\u043e\u043b\u0430\u0434\u044b.",gratitude:"\u049a\u0430\u0442\u044b\u0441\u049b\u0430\u043d\u044b\u04a3\u044b\u0437 \u04af\u0448\u0456\u043d \u0440\u0430\u0445\u043c\u0435\u0442 \ud83d\udc99",redirectText:" \u0441\u0435\u043a\u0443\u043d\u0434\u0442\u0430\u043d \u043a\u0435\u0439\u0456\u043d \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u043a\u0435 \u04e9\u0442\u0435\u043c\u0456\u0437...",redirecting:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433\u043a\u0435 \u04e9\u0442\u0443\u0434\u0435...",viewLeaderboard:"\ud83c\udfc6 \u0420\u0435\u0439\u0442\u0438\u043d\u0433\u0442\u0456 \u049b\u0430\u0440\u0430\u0443",returnHome:"\ud83c\udfe0 \u0411\u0430\u0441\u0442\u044b \u0431\u0435\u0442\u043a\u0435 \u049b\u0430\u0439\u0442\u0443"}};function u(e){let{onComplete:s}=e;const{user:a}=(0,l.A)(),[t,i]=(0,n.useState)(5),[r,o]=(0,n.useState)(!1),d=(null===a||void 0===a?void 0:a.language)||"en",u=m[d]||m.en;return(0,n.useEffect)(()=>{const e=setTimeout(()=>{o(!0)},2e3),a=setInterval(()=>{i(e=>e<=1?(clearInterval(a),s&&s(),0):e-1)},1e3);return()=>{clearTimeout(e),clearInterval(a)}},[s]),(0,c.jsxs)("div",{className:"end-scene fullscreen-ad",children:[(0,c.jsxs)("div",{className:"main-message ".concat(r?"slide-up":""),children:[(0,c.jsx)("div",{className:"celebration-emoji",children:"\ud83c\udf89"}),(0,c.jsx)("h1",{className:"main-title",children:u.title}),(0,c.jsxs)("div",{className:"main-thank-you",children:[(0,c.jsx)("p",{className:"message-line",children:u.message1}),(0,c.jsx)("p",{className:"message-line highlight",children:u.message2}),(0,c.jsx)("p",{className:"message-line highlight",children:u.message3}),(0,c.jsx)("p",{className:"message-line",children:u.message4}),(0,c.jsx)("p",{className:"gratitude-text",children:u.gratitude})]})]}),r&&(0,c.jsx)("div",{className:"all-languages-container",children:(0,c.jsx)("div",{className:"languages-grid",children:Object.entries(m).map(e=>{let[s,a]=e;return(0,c.jsxs)("div",{className:"language-card ".concat(s===d?"active-lang":""),children:[(0,c.jsx)("div",{className:"lang-code",children:s.toUpperCase()}),(0,c.jsx)("h3",{className:"lang-title",children:a.title}),(0,c.jsx)("p",{className:"lang-gratitude",children:a.gratitude})]},s)})})}),(0,c.jsxs)("div",{className:"bottom-fixed",children:[(0,c.jsx)("div",{className:"auto-redirect",children:(0,c.jsx)("p",{className:"redirect-text",children:t>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"countdown",children:t}),u.redirectText]}):u.redirecting})}),(0,c.jsxs)("div",{className:"end-buttons",children:[s&&(0,c.jsx)("button",{className:"end-btn primary",onClick:s,children:u.viewLeaderboard}),(0,c.jsx)("button",{className:"end-btn secondary",onClick:()=>window.location.reload(),children:u.returnHome})]})]})]})}var g=a(339);const h=["Personal Background","Orientation Week Team Building","Admissions","Faculty","Education and Curriculum","Academic Advisor","Academic Affairs","Study Abroad","Student Services","Residence","Facilities","IT Resources: SAIS, SMART, E-Mail & Attendance App","Library","Meals","Counseling Services","Student Belongingness","Extra-curricular Activities","Employment in Korea","Frequency Mode","At a Glance"],v=e=>{if(!e)return Number.MAX_SAFE_INTEGER;const s=String(e).match(/\d+/);return s?Number(s[0]):Number.MAX_SAFE_INTEGER},x=e=>{var s,a;let{onComplete:m}=e;const{user:x,answerQuestion:p,gameStats:N}=(0,l.A)(),[j,b]=(0,n.useState)([]),[y,f]=(0,n.useState)(!0),[S,k]=(0,n.useState)(0),[q,w]=(0,n.useState)(0),[A,C]=(0,n.useState)({}),[I,T]=(0,n.useState)(Date.now()),[E,L]=(0,n.useState)(!1),[D,F]=(0,n.useState)(!1),B=(null===x||void 0===x?void 0:x.language)||"en";(0,n.useEffect)(()=>{(async()=>{try{f(!0);let e=(await(0,i.GG)((0,i.rJ)(r.db,"questions"))).docs.map(e=>(0,t.A)({docId:e.id},e.data()));e.sort((e,s)=>v(e.id)-v(s.id));const s={};for(const t of e){const e=t.category||"Others";s[e]||(s[e]=[]),s[e].push(t)}const a=h.reduce((e,a)=>{const t=s[a];return t&&t.length>0&&e.push({name:a,questions:t}),e},[]);0===a.length&&g.Ay.error("No questions found in Firestore"),b(a),k(0),w(0),C({}),L(!1),T(Date.now())}catch(e){console.error("\u274c Failed to load questions:",e),g.Ay.error("Failed to load questions")}finally{f(!1)}})()},[]);const H=j[S]||null,R=H?H.questions:[],M=R.length>0?R[q]:null,O=(0,n.useMemo)(()=>j.reduce((e,s)=>e+s.questions.length,0),[j]),_=(0,n.useMemo)(()=>Object.keys(A).length,[A]),Q={current:_,total:O},z=q+1,G=R.length,J=function(e,s){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=(Date.now()-I)/1e3;C(i=>(0,t.A)((0,t.A)({},i),{},{[e.docId]:{value:s,skipped:a,timeSpent:n}})),p(n,"good"),T(Date.now())},P=()=>{if(!j.length||!H)return;const e=q>=R.length-1,s=S>=j.length-1;if(!e)return w(e=>e+1),void T(Date.now());s?F(!0):(k(e=>e+1),w(0),T(Date.now()))},X=async()=>{f(!0);const e=await(async()=>{try{const e={userId:x.id||"anonymous",userName:x.name||"Anonymous",studentId:x.studentId||"",department:x.department||"",language:B,gameStats:{level:N.level,experience:N.experience,coins:N.coins,questionsAnswered:N.questionsAnswered},answers:Object.entries(A).map(e=>{let[s,a]=e;return{questionId:s,value:a.value,skipped:a.skipped,timeSpent:a.timeSpent}}),totalQuestions:O,answeredQuestions:_,completedAt:(0,i.O5)(),submittedAt:(new Date).toISOString()};return await(0,i.gS)((0,i.rJ)(r.db,"responses"),e),console.log("\u2705 \uc124\ubb38 \uc751\ub2f5\uc774 Firebase\uc5d0 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4!"),!0}catch(e){return console.error("\u274c Firebase \uc800\uc7a5 \uc2e4\ud328:",e),g.Ay.error("\uc751\ub2f5 \uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),!1}})();f(!1),e&&(g.Ay.success("\ud83c\udf89 \uc124\ubb38\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc81c\ucd9c\ub418\uc5c8\uc2b5\ub2c8\ub2e4!"),L(!0),setTimeout(()=>{m&&m()},3e3))};if(D&&!E)return(0,c.jsx)("div",{className:"survey-container",children:(0,c.jsx)("div",{className:"submit-confirm-screen",children:(0,c.jsxs)("div",{className:"submit-card",children:[(0,c.jsx)("div",{className:"check-icon",children:"\u2705"}),(0,c.jsx)("h2",{children:"\uc124\ubb38 \uc644\ub8cc!"}),(0,c.jsxs)("p",{className:"confirm-message",children:["\ubaa8\ub4e0 \ubb38\ud56d\uc5d0 \uc751\ub2f5\ud558\uc168\uc2b5\ub2c8\ub2e4.",(0,c.jsx)("br",{}),"\uc124\ubb38\uc744 \uc81c\ucd9c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"]}),(0,c.jsxs)("div",{className:"stats-summary",children:[(0,c.jsxs)("div",{className:"stat-item",children:[(0,c.jsx)("span",{className:"stat-label",children:"\ucd1d \ubb38\ud56d \uc218"}),(0,c.jsx)("span",{className:"stat-value",children:O})]}),(0,c.jsxs)("div",{className:"stat-item",children:[(0,c.jsx)("span",{className:"stat-label",children:"\uc751\ub2f5 \uc218"}),(0,c.jsx)("span",{className:"stat-value",children:_})]}),(0,c.jsxs)("div",{className:"stat-item",children:[(0,c.jsx)("span",{className:"stat-label",children:"\ub2ec\uc131 \ub808\ubca8"}),(0,c.jsxs)("span",{className:"stat-value",children:["Lv.",N.level]})]})]}),(0,c.jsxs)("div",{className:"submit-buttons",children:[(0,c.jsx)("button",{className:"submit-btn primary",onClick:X,disabled:y,children:y?"\uc81c\ucd9c \uc911...":"\u2728 \uc124\ubb38 \uc81c\ucd9c\ud558\uae30"}),(0,c.jsx)("button",{className:"submit-btn secondary",onClick:()=>F(!1),disabled:y,children:"\ub3cc\uc544\uac00\uae30"})]})]})})});if(E)return(0,c.jsx)(u,{onComplete:m});if(y)return(0,c.jsx)("div",{className:"survey-container",children:(0,c.jsx)("div",{className:"loading-screen",children:"Loading questions..."})});if(!H||!M)return(0,c.jsx)("div",{className:"survey-container",children:(0,c.jsx)("div",{className:"loading-screen",children:"No questions available"})});const W={text:(null===(s=M.text)||void 0===s?void 0:s[B])||(null===(a=M.text)||void 0===a?void 0:a.en)||"",section:H.name,type:M.type,options:(K=M.options,K?Array.isArray(K)?K:String(K).split(/[\|,]/g).map(e=>e.trim()).filter(e=>e.length>0):[]),required:!0};var K;return(0,c.jsxs)("div",{className:"survey-container",children:[(0,c.jsx)(d,{overallProgress:Q}),(0,c.jsx)(o,{question:W,questionNumber:z,totalQuestions:G,overallNumber:_+1,overallTotal:O,chapterNumber:S+1,chapterName:H.name,sectionIndex:z,sectionTotal:G,onAnswer:e=>{M&&(J(M,e,!1),P())},onBack:()=>{if(!j.length)return;if(0===S&&0===q)return;if(q>0)return w(e=>e-1),void T(Date.now());const e=S-1,s=j[e].questions.length-1;k(e),w(s),T(Date.now())},onSkip:()=>{M&&(J(M,null,!0),P())},onJump:()=>{if(!H||!M)return;const e=R.length-1;if(q>=e)return;const s=(Date.now()-I)/1e3;C(a=>{const n=(0,t.A)({},a);for(let t=q;t<e;t+=1){const e=R[t];n[e.docId]||(n[e.docId]={value:null,skipped:!0,timeSpent:t===q?s:0})}return n}),p(s,"good"),w(e),T(Date.now())}},M.docId)]})}}}]);
//# sourceMappingURL=979.9f0e8f81.chunk.js.map