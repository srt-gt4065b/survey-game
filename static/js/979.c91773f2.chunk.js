"use strict";(self.webpackChunkgamified_survey_system=self.webpackChunkgamified_survey_system||[]).push([[979],{324:(e,s,t)=>{t.d(s,{db:()=>o});var n=t(64),a=t(472),l=t(786),i=t(437),c=t(147);const r=(0,n.Wp)({apiKey:"AIzaSyBqp2_7rcy55Et1NkfRMegiLr5eBIt-N-Q",authDomain:"ecis-fall2025-survey.firebaseapp.com",databaseURL:"https://ecis-fall2025-survey-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"ecis-fall2025-survey",storageBucket:"ecis-fall2025-survey.firebasestorage.app",messagingSenderId:"241188755914",appId:"1:241188755914:web:cc9242e9c1ccf0c17f9733"}),o=(0,a.aU)(r);(0,l.xI)(r),(0,c.c7)(r);let d=null;"undefined"!==typeof window&&(0,i.TT)().then(e=>{if(e)try{d=(0,i.P5)(r)}catch(s){console.log("Analytics \ube44\ud65c\uc131\ud654\ub428")}}).catch(()=>{console.log("Analytics \uc9c0\uc6d0 \uc548\ub428")}),(0,a.ol)(o).catch(e=>{"failed-precondition"===e.code?console.log("\uc624\ud504\ub77c\uc778 \uc9c0\uc6d0\uc774 \uc774\ubbf8 \ub2e4\ub978 \ud0ed\uc5d0\uc11c \ud65c\uc131\ud654\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4."):"unimplemented"===e.code&&console.log("\ud604\uc7ac \ube0c\ub77c\uc6b0\uc800\ub294 \uc624\ud504\ub77c\uc778 \uc9c0\uc6d0\uc744 \uc81c\uacf5\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.")})},979:(e,s,t)=>{t.r(s),t.d(s,{default:()=>v});var n=t(555),a=t(43),l=t(472),i=t(324),c=t(177),r=t(579);const o=e=>{let{question:s,questionNumber:t,totalQuestions:n,chapterNumber:l,chapterName:i,onAnswer:c,onBack:o,onSkip:d,onJump:u}=e;const[m,p]=(0,a.useState)(null),[h,v]=(0,a.useState)("");(0,a.useEffect)(()=>{p(null),v("")},[s]);const x=(()=>{const e=s.options;if(console.log("\ud83d\udd0d Raw options:",e,"Type:",typeof e),!e)return[];if(Array.isArray(e)){if(1===e.length&&"string"===typeof e[0]&&e[0].includes("|")){const s=e[0].split("|").map(e=>e.trim()).filter(Boolean);return console.log("\ud83d\udd27 Split from array[0]:",s),s}return console.log("\u2705 Already array:",e),e}if("string"===typeof e){if(e.includes("|")){const s=e.split("|").map(e=>e.trim()).filter(Boolean);return console.log("\ud83d\udd27 Split by pipe:",s),s}if(e.includes(",")){const s=e.split(",").map(e=>e.trim()).filter(Boolean);return console.log("\ud83d\udd27 Split by comma:",s),s}return console.log("\u26a0\ufe0f Single value:",[e.trim()]),[e.trim()]}return[]})();console.log("\ud83d\udccb Final optionList:",x,"Length:",x.length);const N=(e,s)=>{p(s)},j="text"===s.type?h.trim().length>0:null!==m,b=x.length>1;return(0,r.jsxs)("div",{className:"question-card",children:[(0,r.jsxs)("div",{className:"qc-section-header",children:[(0,r.jsxs)("div",{className:"qc-section-left",children:[(0,r.jsxs)("span",{className:"qc-section-number",children:["Section ",l,"."]}),(0,r.jsx)("span",{className:"qc-section-name",children:i})]}),(0,r.jsxs)("div",{className:"qc-section-progress",children:[t," / ",n]})]}),(0,r.jsx)("h2",{className:"qc-question-text",children:s.text}),"text"===s.type&&(0,r.jsx)("textarea",{className:"qc-textarea",placeholder:"Write your answer...",value:h,onChange:e=>v(e.target.value)}),("multi"===s.type||"likert"===s.type)&&b&&(0,r.jsx)("div",{className:"qc-options-wrapper",children:x.map((e,t)=>(0,r.jsxs)("button",{className:"qc-option-btn ".concat(m===t?"selected":""),onClick:()=>N(0,t),children:["multi"===s.type&&(0,r.jsx)("span",{className:"qc-option-number",children:t+1}),(0,r.jsx)("span",{className:"qc-option-text",children:e})]},t))}),("multi"===s.type||"likert"===s.type)&&!b&&(0,r.jsx)("div",{className:"qc-options-wrapper",children:["Strongly Agree","Agree","Neutral","Disagree","Strongly Disagree"].map((e,s)=>(0,r.jsx)("button",{className:"qc-option-btn ".concat(m===s?"selected":""),onClick:()=>N(0,s),children:(0,r.jsx)("span",{className:"qc-option-text",children:e})},s))}),(0,r.jsxs)("div",{className:"qc-button-row",children:[(0,r.jsxs)("button",{className:"qc-btn back",onClick:()=>{p(null),v(""),o&&o()},children:[(0,r.jsx)("span",{className:"btn-icon",children:"\u2190"}),(0,r.jsx)("span",{className:"btn-label",children:"Back"})]}),(0,r.jsxs)("button",{className:"qc-btn skip",onClick:()=>{p(null),v(""),d&&d()},children:[(0,r.jsx)("span",{className:"btn-icon",children:"\u23ed"}),(0,r.jsx)("span",{className:"btn-label",children:"Skip"})]}),(0,r.jsxs)("button",{className:"qc-btn jump",onClick:()=>{p(null),v(""),u&&u()},children:[(0,r.jsx)("span",{className:"btn-icon",children:"\u2192"}),(0,r.jsx)("span",{className:"btn-label",children:"Jump"})]}),(0,r.jsxs)("button",{className:"qc-btn next ".concat(j?"active":""),disabled:!j,onClick:()=>{"text"===s.type?h.trim()&&(c(h),v("")):null!==m&&(c(x[m]),p(null))},children:[(0,r.jsx)("span",{className:"btn-label",children:"Next"}),(0,r.jsx)("span",{className:"btn-icon",children:"\u2192"})]})]})]})},d=e=>{let{overallProgress:s}=e;const{user:t,gameStats:n}=(0,c.A)();return(0,r.jsxs)("div",{className:"game-header",children:[(0,r.jsxs)("div",{className:"user-info-section",children:[(0,r.jsx)("div",{className:"user-avatar",children:(null===t||void 0===t?void 0:t.avatar)||"\ud83c\udf93"}),(0,r.jsxs)("div",{className:"user-details",children:[(0,r.jsx)("div",{className:"user-name",children:(null===t||void 0===t?void 0:t.name)||"Student"}),(0,r.jsxs)("div",{className:"user-meta",children:[(null===t||void 0===t?void 0:t.studentId)&&(0,r.jsxs)("span",{children:["ID: ",t.studentId]}),(null===t||void 0===t?void 0:t.department)&&(0,r.jsx)("span",{className:"user-dept",children:t.department})]})]})]}),s&&(0,r.jsxs)("div",{className:"overall-progress-section",children:[(0,r.jsxs)("div",{className:"progress-text",children:["Overall Progress: ",s.current," / ",s.total]}),(0,r.jsx)("div",{className:"progress-bar-container",children:(0,r.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(s.current/s.total*100,"%")}})})]}),(0,r.jsxs)("div",{className:"stats-row",children:[(0,r.jsxs)("div",{className:"stat-box",children:[(0,r.jsx)("div",{className:"stat-icon",children:"\u2b50"}),(0,r.jsx)("div",{className:"stat-value",children:(null===n||void 0===n?void 0:n.level)||1}),(0,r.jsx)("div",{className:"stat-label",children:"Level"})]}),(0,r.jsxs)("div",{className:"stat-box",children:[(0,r.jsx)("div",{className:"stat-icon",children:"\ud83d\udcaf"}),(0,r.jsx)("div",{className:"stat-value",children:(null===n||void 0===n?void 0:n.experience)||0}),(0,r.jsx)("div",{className:"stat-label",children:"EXP"})]}),(0,r.jsxs)("div",{className:"stat-box",children:[(0,r.jsx)("div",{className:"stat-icon",children:"\ud83d\udd25"}),(0,r.jsx)("div",{className:"stat-value",children:(null===n||void 0===n?void 0:n.streak)||0}),(0,r.jsx)("div",{className:"stat-label",children:"Streak"})]}),(0,r.jsxs)("div",{className:"stat-box",children:[(0,r.jsx)("div",{className:"stat-icon",children:"\ud83e\ude99"}),(0,r.jsx)("div",{className:"stat-value",children:(null===n||void 0===n?void 0:n.coins)||0}),(0,r.jsx)("div",{className:"stat-label",children:"Coins"})]})]})]})};function u(e){let{onComplete:s}=e;return(0,r.jsx)("div",{className:"end-scene",children:(0,r.jsxs)("div",{className:"end-scene-card",children:[(0,r.jsx)("div",{className:"celebration-emoji",children:"\ud83c\udf89"}),(0,r.jsx)("h1",{children:"Great Job!"}),(0,r.jsx)("p",{children:"Your survey game mission has been successfully completed!"}),(0,r.jsx)("p",{className:"thank-you",children:"Thank you for your valuable feedback."}),(0,r.jsxs)("div",{className:"end-buttons",children:[s&&(0,r.jsx)("button",{className:"end-btn primary",onClick:s,children:"\ud83c\udfc6 View Leaderboard"}),(0,r.jsx)("button",{className:"end-btn secondary",onClick:()=>window.location.reload(),children:"\ud83c\udfe0 Return to Home"})]})]})})}var m=t(339);const p=["Personal Background","Orientation Week Team Building","Admissions","Faculty","Education and Curriculum","Academic Advisor","Academic Affairs","Study Abroad","Student Services","Residence","Facilities","IT Resources: SAIS, SMART, E-Mail & Attendance App","Library","Meals","Counseling Services","Student Belongingness","Extra-curricular Activities","Employment in Korea","Frequency Mode","At a Glance"],h=e=>{if(!e)return Number.MAX_SAFE_INTEGER;const s=String(e).match(/\d+/);return s?Number(s[0]):Number.MAX_SAFE_INTEGER},v=e=>{var s,t;let{onComplete:v}=e;const{user:x,answerQuestion:N}=(0,c.A)(),[j,b]=(0,a.useState)([]),[g,y]=(0,a.useState)(!0),[f,q]=(0,a.useState)(0),[A,S]=(0,a.useState)(0),[k,w]=(0,a.useState)({}),[I,C]=(0,a.useState)(Date.now()),[D,E]=(0,a.useState)(!1),B=(null===x||void 0===x?void 0:x.language)||"en";(0,a.useEffect)(()=>{(async()=>{try{y(!0);let e=(await(0,l.GG)((0,l.rJ)(i.db,"questions"))).docs.map(e=>(0,n.A)({docId:e.id},e.data()));e.sort((e,s)=>h(e.id)-h(s.id));const s={};for(const n of e){const e=n.category||"Others";s[e]||(s[e]=[]),s[e].push(n)}const t=p.reduce((e,t)=>{const n=s[t];return n&&n.length>0&&e.push({name:t,questions:n}),e},[]);0===t.length&&m.Ay.error("No questions found in Firestore"),b(t),q(0),S(0),w({}),E(!1),C(Date.now())}catch(e){console.error("\u274c Failed to load questions:",e),m.Ay.error("Failed to load questions")}finally{y(!1)}})()},[]);const T=j[f]||null,F=T?T.questions:[],M=F.length>0?F[A]:null,R=(0,a.useMemo)(()=>j.reduce((e,s)=>e+s.questions.length,0),[j]),_=(0,a.useMemo)(()=>Object.keys(k).length,[k]),L={current:_,total:R},G=A+1,P=F.length,J=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=(Date.now()-I)/1e3;w(l=>(0,n.A)((0,n.A)({},l),{},{[e.docId]:{value:s,skipped:t,timeSpent:a}})),N(a,"good"),C(Date.now())},O=()=>{if(!j.length||!T)return;const e=A>=F.length-1,s=f>=j.length-1;return e?s?(m.Ay.success("\ud83c\udf89 All survey completed!"),E(!0),void(v&&v())):(q(e=>e+1),S(0),void C(Date.now())):(S(e=>e+1),void C(Date.now()))};if(D)return(0,r.jsx)(u,{onComplete:v});if(g)return(0,r.jsx)("div",{className:"survey-container",children:(0,r.jsx)("div",{className:"loading-screen",children:"Loading questions..."})});if(!T||!M)return(0,r.jsx)("div",{className:"survey-container",children:(0,r.jsx)("div",{className:"loading-screen",children:"No questions available"})});const Q={text:(null===(s=M.text)||void 0===s?void 0:s[B])||(null===(t=M.text)||void 0===t?void 0:t.en)||"",section:T.name,type:M.type,options:(W=M.options,W?Array.isArray(W)?W:String(W).split(/[\|,]/g).map(e=>e.trim()).filter(e=>e.length>0):[]),required:!0};var W;return(0,r.jsxs)("div",{className:"survey-container",children:[(0,r.jsx)(d,{overallProgress:L}),(0,r.jsx)(o,{question:Q,questionNumber:G,totalQuestions:P,overallNumber:_+1,overallTotal:R,chapterNumber:f+1,chapterName:T.name,sectionIndex:G,sectionTotal:P,onAnswer:e=>{M&&(J(M,e,!1),O())},onBack:()=>{if(!j.length)return;if(0===f&&0===A)return;if(A>0)return S(e=>e-1),void C(Date.now());const e=f-1,s=j[e].questions.length-1;q(e),S(s),C(Date.now())},onSkip:()=>{M&&(J(M,null,!0),O())},onJump:()=>{if(!T||!M)return;const e=F.length-1;if(A>=e)return;const s=(Date.now()-I)/1e3;w(t=>{const a=(0,n.A)({},t);for(let n=A;n<e;n+=1){const e=F[n];a[e.docId]||(a[e.docId]={value:null,skipped:!0,timeSpent:n===A?s:0})}return a}),N(s,"good"),S(e),C(Date.now())}},M.docId)]})}}}]);
//# sourceMappingURL=979.c91773f2.chunk.js.map