"use strict";(self.webpackChunkgamified_survey_system=self.webpackChunkgamified_survey_system||[]).push([[979],{979:(e,s,t)=>{t.r(s),t.d(s,{default:()=>x});var n=t(555),a=t(43),l=t(472),i=t(335),r=t(177),o=t(579);const c=e=>{let{question:s,questionNumber:t,totalQuestions:n,overallNumber:l,overallTotal:i,onAnswer:r,onSkip:c,onBack:d,onJump:u}=e;const[v,m]=(0,a.useState)(""),{text:h,type:x,options:N,section:j}=s,p="likert"===x?["\ud83d\ude0d Strongly Agree","\ud83d\ude42 Agree","\ud83d\ude10 Neutral","\ud83d\ude15 Disagree","\ud83d\ude21 Strongly Disagree"]:(e=>e?Array.isArray(e)?e:e.split(/[\|,]/g).map(e=>e.trim()).filter(e=>e.length>0):[])(N);return(0,o.jsxs)("div",{className:"question-card fade-in",children:[(0,o.jsxs)("div",{className:"q-header",children:[(0,o.jsxs)("div",{className:"q-section",children:["Section ",j]}),(0,o.jsxs)("div",{className:"q-progress-group",children:[(0,o.jsxs)("div",{className:"q-progress-chapter",children:[t," / ",n]}),(0,o.jsxs)("div",{className:"q-progress-overall",children:["Overall: ",l," / ",i]})]})]}),(0,o.jsx)("h2",{className:"q-text",children:h}),("multi"===x||"single"===x||"likert"===x)&&p.length>0&&(0,o.jsx)("div",{className:"q-options",children:p.map((e,s)=>(0,o.jsx)("button",{className:"q-option ".concat(v===e?"selected":""),onClick:()=>m(e),children:e},s))}),"text"===x&&(0,o.jsx)("textarea",{className:"q-textarea",placeholder:"Write your answer...",value:v,onChange:e=>m(e.target.value)}),(0,o.jsxs)("div",{className:"q-footer",children:[(0,o.jsx)("button",{className:"back-btn",onClick:d,children:"\u2190 Back"}),(0,o.jsx)("button",{className:"skip-btn",onClick:()=>c(),children:"\u23ed Skip"}),(0,o.jsx)("button",{className:"jump-btn",onClick:()=>u(),children:"\u279f Jump"}),(0,o.jsx)("button",{className:"next-btn ".concat(v?"active":""),disabled:!v,onClick:()=>{v&&(r(v),m(""))},children:"Next \u2192"})]})]})},d=e=>{let{overallProgress:s}=e;const{user:t,gameStats:n}=(0,r.A)();return(0,o.jsxs)("div",{className:"game-header",children:[(0,o.jsxs)("div",{className:"user-info-section",children:[(0,o.jsx)("div",{className:"user-avatar",children:(null===t||void 0===t?void 0:t.avatar)||"\ud83c\udf93"}),(0,o.jsxs)("div",{className:"user-details",children:[(0,o.jsx)("div",{className:"user-name",children:(null===t||void 0===t?void 0:t.name)||"Student"}),(0,o.jsxs)("div",{className:"user-meta",children:[(null===t||void 0===t?void 0:t.studentId)&&(0,o.jsxs)("span",{children:["ID: ",t.studentId]}),(null===t||void 0===t?void 0:t.department)&&(0,o.jsx)("span",{className:"user-dept",children:t.department})]})]})]}),s&&(0,o.jsxs)("div",{className:"overall-progress-section",children:[(0,o.jsxs)("div",{className:"progress-text",children:["Overall Progress: ",s.current," / ",s.total]}),(0,o.jsx)("div",{className:"progress-bar-container",children:(0,o.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(s.current/s.total*100,"%")}})})]}),(0,o.jsxs)("div",{className:"stats-row",children:[(0,o.jsxs)("div",{className:"stat-box",children:[(0,o.jsx)("div",{className:"stat-icon",children:"\u2b50"}),(0,o.jsx)("div",{className:"stat-value",children:(null===n||void 0===n?void 0:n.level)||1}),(0,o.jsx)("div",{className:"stat-label",children:"Level"})]}),(0,o.jsxs)("div",{className:"stat-box",children:[(0,o.jsx)("div",{className:"stat-icon",children:"\ud83d\udcaf"}),(0,o.jsx)("div",{className:"stat-value",children:(null===n||void 0===n?void 0:n.experience)||0}),(0,o.jsx)("div",{className:"stat-label",children:"EXP"})]}),(0,o.jsxs)("div",{className:"stat-box",children:[(0,o.jsx)("div",{className:"stat-icon",children:"\ud83d\udd25"}),(0,o.jsx)("div",{className:"stat-value",children:(null===n||void 0===n?void 0:n.streak)||0}),(0,o.jsx)("div",{className:"stat-label",children:"Streak"})]}),(0,o.jsxs)("div",{className:"stat-box",children:[(0,o.jsx)("div",{className:"stat-icon",children:"\ud83e\ude99"}),(0,o.jsx)("div",{className:"stat-value",children:(null===n||void 0===n?void 0:n.coins)||0}),(0,o.jsx)("div",{className:"stat-label",children:"Coins"})]})]})]})};function u(e){let{onComplete:s}=e;return(0,o.jsxs)("div",{className:"end-scene",children:[(0,o.jsx)("h1",{children:"\ud83c\udf89 Great Job!"}),(0,o.jsx)("p",{children:"Your survey game mission has been successfully completed!!."}),(0,o.jsx)("button",{className:"end-btn",onClick:s,children:"\ub9ac\ub354\ubcf4\ub4dc \ubcf4\uae30 \u2192"}),(0,o.jsx)("button",{className:"home-btn",onClick:()=>window.location.reload(),children:"\ucc98\uc74c\uc73c\ub85c \ub3cc\uc544\uac00\uae30"})]})}var v=t(339);const m=["Personal Background","Orientation Week Team Building","Admissions","Faculty","Education and Curriculum","Academic Advisor","Academic Affairs","Study Abroad","Student Services","Residence","Facilities","IT Resources: SAIS, SMART, E-Mail & Attendance App","Library","Meals","Counseling Services","Student Belongingness","Extra-curricular Activities","Employment in Korea","Frequency Mode","At a Glance"],h=e=>{if(!e)return Number.MAX_SAFE_INTEGER;const s=String(e).match(/\d+/);return s?Number(s[0]):Number.MAX_SAFE_INTEGER},x=e=>{var s,t;let{onComplete:x}=e;const{user:N,answerQuestion:j}=(0,r.A)(),[p,g]=(0,a.useState)([]),[b,y]=(0,a.useState)(!0),[A,f]=(0,a.useState)(0),[S,k]=(0,a.useState)(0),[q,w]=(0,a.useState)({}),[C,D]=(0,a.useState)(Date.now()),[I,E]=(0,a.useState)(!1),F=(null===N||void 0===N?void 0:N.language)||"en";(0,a.useEffect)(()=>{(async()=>{try{y(!0);let e=(await(0,l.GG)((0,l.rJ)(i.db,"questions"))).docs.map(e=>(0,n.A)({docId:e.id},e.data()));e.sort((e,s)=>h(e.id)-h(s.id));const s={};for(const n of e){const e=n.category||"Others";s[e]||(s[e]=[]),s[e].push(n)}const t=m.reduce((e,t)=>{const n=s[t];return n&&n.length>0&&e.push({name:t,questions:n}),e},[]);0===t.length&&v.Ay.error("No questions found in Firestore"),g(t),f(0),k(0),w({}),E(!1),D(Date.now())}catch(e){console.error("\u274c Failed to load questions:",e),v.Ay.error("Failed to load questions")}finally{y(!1)}})()},[]);const M=p[A]||null,T=M?M.questions:[],_=T.length>0?T[S]:null,B=(0,a.useMemo)(()=>p.reduce((e,s)=>e+s.questions.length,0),[p]),G=(0,a.useMemo)(()=>Object.keys(q).length,[q]),J={current:G,total:B},O=S+1,P=T.length,R=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=(Date.now()-C)/1e3;w(l=>(0,n.A)((0,n.A)({},l),{},{[e.docId]:{value:s,skipped:t,timeSpent:a}})),j(a,"good"),D(Date.now())},L=()=>{if(!p.length||!M)return;const e=S>=T.length-1,s=A>=p.length-1;return e?s?(v.Ay.success("\ud83c\udf89 All survey completed!"),E(!0),void(x&&x())):(f(e=>e+1),k(0),void D(Date.now())):(k(e=>e+1),void D(Date.now()))};if(I)return(0,o.jsx)(u,{});if(b)return(0,o.jsx)("div",{className:"survey-container",children:(0,o.jsx)("div",{className:"loading-screen",children:"Loading questions..."})});if(!M||!_)return(0,o.jsx)("div",{className:"survey-container",children:(0,o.jsx)("div",{className:"loading-screen",children:"No questions available"})});const Q={text:(null===(s=_.text)||void 0===s?void 0:s[F])||(null===(t=_.text)||void 0===t?void 0:t.en)||"",section:M.name,type:_.type,options:(X=_.options,X?Array.isArray(X)?X:String(X).split(/[\|,]/g).map(e=>e.trim()).filter(e=>e.length>0):[]),required:!0};var X;return(0,o.jsxs)("div",{className:"survey-container",children:[(0,o.jsx)(d,{overallProgress:J}),(0,o.jsx)(c,{question:Q,questionNumber:O,totalQuestions:P,overallNumber:G+1,overallTotal:B,chapterNumber:A+1,chapterName:M.name,sectionIndex:O,sectionTotal:P,onAnswer:e=>{_&&(R(_,e,!1),L())},onBack:()=>{if(!p.length)return;if(0===A&&0===S)return;if(S>0)return k(e=>e-1),void D(Date.now());const e=A-1,s=p[e].questions.length-1;f(e),k(s),D(Date.now())},onSkip:()=>{_&&(R(_,null,!0),L())},onJump:()=>{if(!M||!_)return;const e=T.length-1;if(S>=e)return;const s=(Date.now()-C)/1e3;w(t=>{const a=(0,n.A)({},t);for(let n=S;n<e;n+=1){const e=T[n];a[e.docId]||(a[e.docId]={value:null,skipped:!0,timeSpent:n===S?s:0})}return a}),j(s,"good"),k(e),D(Date.now())}},_.docId)]})}}}]);
//# sourceMappingURL=979.37c6f95d.chunk.js.map