"use strict";(self.webpackChunkgamified_survey_system=self.webpackChunkgamified_survey_system||[]).push([[357],{324:(e,s,a)=>{a.d(s,{db:()=>o});var t=a(64),l=a(472),r=a(786),i=a(437),n=a(147);const c=(0,t.Wp)({apiKey:"AIzaSyBqp2_7rcy55Et1NkfRMegiLr5eBIt-N-Q",authDomain:"ecis-fall2025-survey.firebaseapp.com",databaseURL:"https://ecis-fall2025-survey-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"ecis-fall2025-survey",storageBucket:"ecis-fall2025-survey.firebasestorage.app",messagingSenderId:"241188755914",appId:"1:241188755914:web:cc9242e9c1ccf0c17f9733"}),o=(0,l.aU)(c);(0,r.xI)(c),(0,n.c7)(c);let d=null;"undefined"!==typeof window&&(0,i.TT)().then(e=>{if(e)try{d=(0,i.P5)(c)}catch(s){console.log("Analytics \ube44\ud65c\uc131\ud654\ub428")}}).catch(()=>{console.log("Analytics \uc9c0\uc6d0 \uc548\ub428")}),(0,l.ol)(o).catch(e=>{"failed-precondition"===e.code?console.log("\uc624\ud504\ub77c\uc778 \uc9c0\uc6d0\uc774 \uc774\ubbf8 \ub2e4\ub978 \ud0ed\uc5d0\uc11c \ud65c\uc131\ud654\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4."):"unimplemented"===e.code&&console.log("\ud604\uc7ac \ube0c\ub77c\uc6b0\uc800\ub294 \uc624\ud504\ub77c\uc778 \uc9c0\uc6d0\uc744 \uc81c\uacf5\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.")})},357:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var t=a(555),l=a(43),r=a(472),i=a(324),n=a(177),c=a(579);const o=e=>e?Array.isArray(e)?e:"string"===typeof e?e.split(/[\|,\n;\r]+/g).map(e=>e.trim()).filter(e=>e.length>0):[]:[],d=e=>{let{question:s,questionNumber:a,totalQuestions:t,overallNumber:r,overallTotal:i,onAnswer:n}=e;const{text:d,type:u,options:v,section:m}=s,h=u||"",x=h.toLowerCase().includes("multi"),[g,p]=(0,l.useState)(x?[]:"");(0,l.useEffect)(()=>{p(x?[]:"")},[a,x]);const N="likert"===h.toLowerCase()?["\ud83d\ude0d Strongly Agree","\ud83d\ude42 Agree","\ud83d\ude10 Neutral","\ud83d\ude15 Disagree","\ud83d\ude21 Strongly Disagree"]:o(v),y=x?Array.isArray(g)&&g.length>0:!!g;return(0,c.jsxs)("div",{className:"question-card fade-in",children:[(0,c.jsxs)("div",{className:"q-header",children:[(0,c.jsx)("div",{className:"q-section",children:m}),(0,c.jsxs)("div",{className:"q-progress-group",children:[(0,c.jsxs)("div",{className:"q-progress-chapter",children:["Chapter: ",a," / ",t]}),(0,c.jsxs)("div",{className:"q-progress-overall",children:["Overall: ",r," / ",i]})]})]}),(0,c.jsxs)("h2",{className:"q-text",children:[d,x&&(0,c.jsx)("span",{style:{fontSize:"0.7em",color:"#666",marginLeft:"10px",fontWeight:"normal"},children:"(Select all that apply)"})]}),"text"!==h&&(0,c.jsx)("div",{className:"q-options",children:N.map((e,s)=>{const a=x?Array.isArray(g)&&g.includes(e):g===e;return(0,c.jsxs)("button",{className:"q-option ".concat(a?"selected":""),onClick:()=>(e=>{x?Array.isArray(g)?g.includes(e)?p(g.filter(s=>s!==e)):p([...g,e]):p([e]):p(e)})(e),children:[x&&(a?"\u2705 ":"\u2b1c "),e]},s)})}),"text"===h&&(0,c.jsx)("textarea",{className:"q-textarea",placeholder:"Write your answer...",value:g,onChange:e=>p(e.target.value)}),(0,c.jsx)("div",{className:"q-footer",children:(0,c.jsx)("button",{className:"next-btn ".concat(y?"active":""),disabled:!y,onClick:()=>{y&&n(g)},children:"Next \u2192"})})]})},u=e=>{let{overallProgress:s}=e;const{user:a,gameStats:t}=(0,n.A)();return(0,c.jsxs)("div",{className:"game-header",children:[(0,c.jsxs)("div",{className:"user-info-section",children:[(0,c.jsx)("div",{className:"user-avatar",children:(null===a||void 0===a?void 0:a.avatar)||"\ud83c\udf93"}),(0,c.jsxs)("div",{className:"user-details",children:[(0,c.jsx)("div",{className:"user-name",children:(null===a||void 0===a?void 0:a.name)||"Student"}),(0,c.jsxs)("div",{className:"user-meta",children:[(null===a||void 0===a?void 0:a.studentId)&&(0,c.jsxs)("span",{children:["ID: ",a.studentId]}),(null===a||void 0===a?void 0:a.department)&&(0,c.jsx)("span",{className:"user-dept",children:a.department})]})]})]}),s&&(0,c.jsxs)("div",{className:"overall-progress-section",children:[(0,c.jsxs)("div",{className:"progress-text",children:["Overall Progress: ",s.current," / ",s.total]}),(0,c.jsx)("div",{className:"progress-bar-container",children:(0,c.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(s.current/s.total*100,"%")}})})]}),(0,c.jsxs)("div",{className:"stats-row",children:[(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\u2b50"}),(0,c.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.level)||1}),(0,c.jsx)("div",{className:"stat-label",children:"Level"})]}),(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\ud83d\udcaf"}),(0,c.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.experience)||0}),(0,c.jsx)("div",{className:"stat-label",children:"EXP"})]}),(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\ud83d\udd25"}),(0,c.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.streak)||0}),(0,c.jsx)("div",{className:"stat-label",children:"Streak"})]}),(0,c.jsxs)("div",{className:"stat-box",children:[(0,c.jsx)("div",{className:"stat-icon",children:"\ud83e\ude99"}),(0,c.jsx)("div",{className:"stat-value",children:(null===t||void 0===t?void 0:t.coins)||0}),(0,c.jsx)("div",{className:"stat-label",children:"Coins"})]})]})]})};var v=a(339);const m=e=>{let{onComplete:s}=e;const{user:a,answerQuestion:o}=(0,n.A)(),[m,h]=(0,l.useState)([]),[x,g]=(0,l.useState)(!0),[p,N]=(0,l.useState)(""),[y,j]=(0,l.useState)(0),[f,b]=(0,l.useState)({}),[A,q]=(0,l.useState)(Date.now()),w=(null===a||void 0===a?void 0:a.language)||"en";(0,l.useEffect)(()=>{(async()=>{try{g(!0);const e=(0,r.P)((0,r.rJ)(i.db,"questions"),(0,r.My)("id")),s=(await(0,r.GG)(e)).docs.map(e=>(0,t.A)({docId:e.id},e.data()));h(s),s.length>0&&N(s[0].category)}catch(e){console.error("\u274c Failed to load questions:",e),v.Ay.error("Failed to load questions")}finally{g(!1),q(Date.now())}})()},[]);const S=(0,l.useMemo)(()=>[...new Set(m.map(e=>e.category))],[m]),I=(0,l.useMemo)(()=>m.filter(e=>e.category===p),[m,p]),k=I.length>0?I[y]:null,C=(0,l.useMemo)(()=>({current:Object.keys(f).length,total:m.length}),[f,m.length]),D=(0,l.useMemo)(()=>{var e,s,a;return k?{text:(null===(e=k.text)||void 0===e?void 0:e[w])||(null===(s=k.text)||void 0===s?void 0:s.en),section:k.category,type:k.type,options:(a=k.options,a?Array.isArray(a)?a:a.split(/[\|,\n;\r]+/g).map(e=>e.trim()).filter(e=>e.length>0):[]),required:!0}:null},[k,w]);return x?(0,c.jsx)("div",{className:"survey-container",children:(0,c.jsx)("div",{className:"loading-screen",children:"Loading questions..."})}):k&&D?(0,c.jsxs)("div",{className:"survey-container",children:[(0,c.jsx)(u,{overallProgress:C}),(0,c.jsx)(d,{question:D,questionNumber:y+1,totalQuestions:I.length,overallNumber:k?m.findIndex(e=>e.docId===k.docId)+1:0,overallTotal:m.length,onAnswer:e=>{if(!k)return;const a=(Date.now()-A)/1e3,l=k.docId;b(s=>(0,t.A)((0,t.A)({},s),{},{[l]:{value:e,timeSpent:a}})),o(a,"good");const r=y+1;if(r<I.length)return j(r),void q(Date.now());v.Ay.success("\ud83c\udf89 ".concat(p," Completed!"));const i=new Set(Object.keys((0,t.A)((0,t.A)({},f),{},{[l]:!0}))),n=S.filter(e=>m.some(s=>s.category===e&&!i.has(s.docId)));if(n.length>0)return N(n[0]),j(0),void q(Date.now());v.Ay.success("\ud83c\udfaf All survey completed!"),s&&s()}},k.docId)]}):(0,c.jsx)("div",{className:"survey-container",children:(0,c.jsx)("div",{className:"loading-screen",children:"No questions available"})})}}}]);
//# sourceMappingURL=357.927625b9.chunk.js.map